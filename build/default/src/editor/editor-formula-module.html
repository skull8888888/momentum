<html><head></head><body><dom-module id="editor-formula-module"><template><style>:host{display:inline-block;color:black;}#input:focus{outline:none;}#input{min-width:40px;font-family:Courier New, Courier, monospace;font-weight:500;background-color:white;position:relative;z-index:2;border:1px solid var(--paper-grey-300);}#formulaWrapper{min-width:40px;max-width:100%;min-height:30px;border:1px solid var(--paper-grey-300);position:absolute;background-color:whitesmoke;z-index:1;}</style><div id="body"><div id="wrapper"><div contenteditable="true" id="input" on-keyup="_editorBodyChanged"></div><div id="formulaWrapper"><math-tex id="math" display="block">[[bodyText]]</math-tex></div></div></div></template><script>class FormulaModule extends Polymer.Element{static get is(){return'editor-formula-module'}static get properties(){return{text:String,hasReplaced:Boolean,math:{type:String,observer:'mathChanged'}}}connectedCallback(){super.connectedCallback(),setTimeout(()=>{this.$.input.focus()}),this.$.input.onkeydown=(a)=>{if(13==a.which&&!1==a.shiftKey&&!this.hasReplaced)return this.setAttribute('math',this.bodyText),this.$.input.onkeydown=null,this.hasReplaced=!0,void this.dispatchEvent(new CustomEvent('formula-added',{bubbles:!0,composed:!0}))}}disconnectedCallback(){updateBookmarks()}mathChanged(a){if(void 0!==a){this.$.wrapper.remove();let b=document.createElement('math-tex');b.setAttribute('display','block'),b.innerText=a,this.$.body.appendChild(b)}}_editorBodyChanged(){this.bodyText=this.$.input.innerText}}window.customElements.define(FormulaModule.is,FormulaModule);</script></dom-module></body></html>